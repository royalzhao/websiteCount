<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>welcome!</title>
    <link rel="stylesheet" href="lib/css/layui.css">
    <link rel="stylesheet" href="./css/style.css">
    
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <div class="container">
        <div class="form">
            <form class="layui-form" action="">
                <div class="layui-form-pane" style="margin-top: 15px; float:left;">
                    <div class="layui-form-item">
                        <label class="layui-form-label">选择日期</label>
                        <div class="layui-input-inline">
                        <input class="layui-input" placeholder="" id="LAY_demorange_s">
                        </div>
                    </div>
                </div> 
                
                <button class="layui-btn" style="margin-top: 15px; float:left;"  lay-submit lay-filter="sreach"><i class="layui-icon">&#xe615;</i></button>   
            </form>
        </div>
        <fieldset class="layui-elem-field layui-field-title site-title">
            <legend>信息统计</legend>
        </fieldset>
        <div class="site_detail">
            <ul>
                <li>
                    <span>浏览时间</span>
                    <span>受访页面</span>
                    <span>IP</span>
                    <span>地区</span>
                </li>
                <li>
                    <span>10:27:58</span>
                    <span>http://www.ackao.cn/sm/wzpzsm2/?&ic=MJe5nR0uaMwy</span>
                    <span>115.33.217.69</span>
                    <span>北京市-北京市</span>
                </li>
                <script id="data-template" type="text/x-handlebars-template">
                    
                    <!--遍历news  -->
                    {{#each datas}}
    
                    <li>
                        <span>10:27:58</span>
                        <span>http://www.ackao.cn/sm/wzpzsm2/?&ic=MJe5nR0uaMwy</span>
                        <span>115.33.217.69</span>
                        <span>北京市-北京市</span>
                    </li>
                    
                    {{/each}}
                </script>
                <span id="data">
                    
                </span>
            </ul>
        </div>
        
    </div>
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
    <script src="lib/layui.js"></script>
    <script src="js/base.js"></script>
    <script>
        layui.use(['laydate','layer'],function(){
            $ = layui.jquery;
            var laydate = layui.laydate;//日期插件
            var layer = layui.layer//弹出层

            //以上模块需要引用

            var time = new Date();
            localYear = time.getFullYear();
            localMonth = time.getMonth()+1;
            localDate = time.getDate();
            local = localYear+'-'+localMonth+'-'+localDate;

            $('#LAY_demorange_s').val(local);

            laydate.render({ 
                elem: '#LAY_demorange_s'
            });

            getData( $('#LAY_demorange_s').val());
            
            layui.use('form', function(){
                var form = layui.form;
                //监听提交
                var data = $('#LAY_demorange_s').val()
                form.on('submit(sreach)', function(data){
                    getData( data);
                });
            });
            
        });

        function getData(time){
            $.ajax({
                url:'',
                data:{
                    date:time
                },
                type:'post',
                dataType:'json',
                success:function(data){
                    console.log(data)
                    //获取模板数据
						
                    var NewsHotTemplateScript =  $('#data-template').html();
                    //Handlebars.compile编译模板
                    
                    var NewsHotTemplate = Handlebars.compile(NewsHotTemplateScript);
                    //定义数据
                    var context = {
                        datas:data,
                    };
                    
                    //把数据传送到模板
                    
                    var HotNewsCompiledHtml = NewsHotTemplate(context);
                   //更新到模板
                    
                    $("#data").append(HotNewsCompiledHtml);
                    
						
                },
                error:function(){
                    console.log('网络错误');
                }
            })
        }
    </script>
   
       
    
        
       
    
</body>
</html>